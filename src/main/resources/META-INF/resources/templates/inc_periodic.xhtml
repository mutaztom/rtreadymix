<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:rteam="http://xmlns.jcp.org/jsf/composite/rteam" xmlns:ui="http://java.sun.com/jsf/facelets">
<f:metadata>

</f:metadata>
<h:head>
    <title>#{msg.mapping}</title>
</h:head>
<h:body>
    <p:panelGrid columns="8"  style="width:100%;">
        <p:outputLabel value="#{msg.filtermethod}"/>
        <p:selectOneButton id="radperiod" value="#{repmanBean.byDuration}" disabled="#{!repmanBean.periodic}" valueChangeListener="#{repmanBean.onPeriodtypeChanged}">
            <f:selectItem itemLabel="#{msg.duration}" itemValue="#{true}" />
            <f:selectItem itemLabel="#{msg.periodic}" itemValue="#{false}" />
            <p:ajax update="panduration,panperiod,info"/>
        </p:selectOneButton>
        <p:outputLabel value="#{msg.year}"/>
        <p:spinner value="#{repmanBean.period.year}" min="2015" id="pyear" disabled="#{repmanBean.disabled}">
            <p:ajax update="info"/>
        </p:spinner>
        <p:spacer width="20"/>
        <p:outputLabel value="#{msg.period}" />
        <p:spacer width="5"/>
        <p:outputLabel id="info" value="#{repmanBean.period.toString()}" style="color:blue;" styleClass="periodinfo"/>
    </p:panelGrid>
    <p:panelGrid columns="1" style="width:100%;">
        <p:fragment id="panduration">
            <p:autoUpdate/>
            <h:panelGrid columns="2"  rendered="#{repmanBean.byDuration}" >
                <h:outputText value="#{msg.duration}"/>
                <p:selectOneMenu id="ddrange" style="width: 200px;font-size: small" disabled="#{repmanBean.disabled}" value="#{repmanBean.shortRange}">
                    <f:selectItems value="#{rtutil.fromEnum('com.rationalteam.core.enShortPeriodRange')}" var="range" itemLabel="#{msg[range.toString().toLowerCase()]}"
                                   itemValue="#{range}" />
                    <p:ajax update="info,pyear,@(.periodinfo)"/>
                </p:selectOneMenu>
            </h:panelGrid>
        </p:fragment>
        <p:fragment id="panperiod" >
            <p:autoUpdate/>
            <jsp:useBean id="repmanBean" scope="request" type="com.rationalteam.rtreports.ReportManager"/>
            <h:panelGrid columns="4" rendered="#{!repmanBean.byDuration}" >
                <p:outputLabel value="#{msg.period}" />
                <p:selectOneMenu value="#{repmanBean.range}" style="width: 250px;" widgetVar="vrange" disabled="#{repmanBean.disabled}">
                    <f:selectItems value="#{rtutil.listRanges()}"
                                   var="p" itemLabel="#{p}" itemValue="#{p.name()}"/>
                    <p:ajax update="info,ddmonth,dtstart,dtend,@(.periodinfo)"/>
                </p:selectOneMenu>
                <p:outputLabel value="#{msg.month}"/>
                <p:selectOneMenu id="ddmonth" value="#{repmanBean.period.month}" style="width:250px;" disabled="#{repmanBean.disabled || repmanBean.range!='Month'}">
                    <f:selectItems value="#{rtutil.listMonths()}" var="m" itemValue="#{rtutil.listMonths().indexOf(m)}" itemLabel="#{m}" />
                    <p:ajax update="info,@(.periodinfo)"/>
                </p:selectOneMenu>
                <p:outputLabel value="#{msg.start}"/>
                <p:calendar id="dtstart" value="#{repmanBean.start}" showOn="button" disabled="#{repmanBean.disabled || repmanBean.range!='Period'}">
                    <p:ajax event="dateSelect" update="dtend,info,@(.periodinfo)"/>
                </p:calendar>
                <p:outputLabel value="#{msg.end}"/>
                <p:calendar id="dtend" value="#{repmanBean.end}" mindate="#{repmanBean.start}" showOn="button" disabled="#{repmanBean.disabled || repmanBean.range!='Period'}">
                    <p:ajax event="dateSelect" update="info,@(.periodinfo)"/>
                </p:calendar>

            </h:panelGrid>
        </p:fragment>
    </p:panelGrid>

</h:body>
</html>

